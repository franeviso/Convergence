#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass scrartcl
\begin_preamble
\usepackage{lineno}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding iso8859-15
\fontencoding T1
\font_roman lmodern
\font_sans default
\font_typewriter lmodern
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing double
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1.5cm
\rightmargin 1.5cm
\bottommargin 1.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title

\size large
Eco-evolutionary diversification of trait convergence and complementarity
 in mutualistic networks 
\end_layout

\begin_layout Author

\size normal
Francisco Encinas-Viso
\begin_inset Formula $^{1,*}$
\end_inset

, Rampal S.
 Etienne
\begin_inset Formula $^{2,**}$
\end_inset

 and Carlos J.
 Melián
\begin_inset Formula $^{3,**}$
\end_inset


\end_layout

\begin_layout Address

\series bold
\begin_inset VSpace defskip
\end_inset


\begin_inset Newline newline
\end_inset


\series default
 
\series bold
1
\series default
) NRCA & Centre for Australian National Biodiversity Research, CSIRO, GPO
 Box 1600 Canberra , Australia 
\begin_inset Newline newline
\end_inset

 
\series bold
2
\series default
) Groningen Institute for Evolutionary Life Sciences, University of Groningen,
 The Netherlands 
\begin_inset Newline newline
\end_inset

 
\series bold
3
\series default
) Department of Fish Ecology and Evolution, Center for Ecology, Evolution
 and Biogeochemistry, EAWAG, Swiss Federal Institute of Aquatic Science
 and Technology, Switzerland
\begin_inset VSpace defskip
\end_inset


\begin_inset Newline newline
\end_inset

 Keywords: Diffuse coevolution, specialization, sexual reproduction, assortative
 mating, dispersal limitation, phylogenetic relatedness, obligate mutualism,
 morphological constraints, individual based model.
\begin_inset VSpace defskip
\end_inset


\begin_inset Newline newline
\end_inset

 Type of Article: Letters
\begin_inset Newline newline
\end_inset

 Number of figures: 7 (6 in color); Number of tables: 1
\begin_inset Newline newline
\end_inset

 * Corresponding author: franencinas@gmail.com
\begin_inset Newline newline
\end_inset

 ** Joint last authorship
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{linenumbers}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset

 
\end_layout

\begin_layout Abstract

\size small
Empirical mutualistic networks composed by several interacting species show
 high levels of trait convergence and complementarity.
 Convergence and complementarity have been attributed to coevolutionary
 selection coming from both plant and animals, selection coming only from
 the mutualistic partners and also due to niche-based processes.
 Non-selective causes like traits evolving due to a Brownian motion can
 also produce evolutionary trait convergence and complementarity.
 Whether coevolutionary selection or non-selective causes are required to
 explain trait convergence and complementarity, the impact of population,
 trait and diversification dynamics on quantitative trait divergence and
 convergence dynamics in species-rich mutualistic networks remains largely
 unexplored.
 Here, we present a landscape genetics model to connect population, trait
 and diversification dynamics to study complementarity, convergence and
 nestedness in species-rich mutualistic networks.
 We compare our model to convergence and complementarity patterns observed
 in a plant-hummingbird mutualistic network to show that population, trait
 and diversification dynamics predict well plant-animal complementarity
 and convergence for animals but not for plants.
 Our analysis also shows that high levels of convergence, complementarity
 and nestedness are possible to predict after controlling by phylogenetic
 relatedness.
 Our results demonstrate that, in contrast to previous models based on coevoluti
onary selection, diversification trait dynamics requires ecological (demography
 and dispersal limitation), genetical (mutation, recombination and assortative
 mating), and morphological processes associated to trait matching to reproduce
 key patterns of mutualistic networks, from trait convergence and complementarit
y to nestedness.
 
\size default

\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
Since Darwin's book 
\begin_inset Quotes eld
\end_inset

On The Origin of Species
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "darwin_origin"

\end_inset

, the idea of coevolution, defined as reciprocal evolutionary trait change
 between species, has sparked interest from biologists trying to understand
 how species interactions generate trait changes.
 The first clear indication of coevolution was Darwin's moth example 
\begin_inset CommandInset citation
LatexCommand citep
key "Darwin_orchids_book"

\end_inset

 showing that the long corolla from the orchid 
\emph on
Angraecum sesquispedale
\emph default
 could only be reached by a pollinator species with a similar or larger
 proboscis length.
 Following the moth and orchid mutualism model system, several studies have
 modeled coevolutionary dynamics of a few species 
\begin_inset CommandInset citation
LatexCommand citep
key "Ferriere-2007,Law2001,Ferdy_2002,Gomulkiewicz-2003,Jones_Ferriere_amnat_2009"

\end_inset

, particularly highly specialized (i.e.
 obligatory mutualists) systems of plant-animal interactions, such as the
 fig-fig wasp mutualism 
\begin_inset CommandInset citation
LatexCommand citep
key "Bronstein-2006"

\end_inset

.
 These studies have determined the ecological conditions for coevolutionary
 stable systems in highly specialized plant-animal interactions 
\begin_inset CommandInset citation
LatexCommand citep
key "Law2001,Jones_Ferriere_amnat_2009"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Janzen_coevolution_1980"

\end_inset

 argued that high specialization between plants and animals was not the
 only example of coevolution, but coevolution can also be the product of
 multiple-species interactions, a term that he coined 
\begin_inset Quotes eld
\end_inset

diffuse coevolution
\begin_inset Quotes erd
\end_inset

.
 Diffuse coevolution means that selection on traits is determined by the
 interaction of more than two species and not only based on pairwise interaction
s.
 This is based on the idea of pollination or dispersal 
\begin_inset Quotes eld
\end_inset

syndromes
\begin_inset Quotes erd
\end_inset

, where plants have a set of traits that attract a specific group of pollinator
 or animal seed-disperser species with traits complementary to those of
 the plants.
 The idea of 
\begin_inset Quotes eld
\end_inset

diffuse coevolution” is thus linked to concepts of complementarity and convergen
ce, and has also been related to patterns of nestedness detected across
 biogeographic regions in mutualistic networks.
 
\end_layout

\begin_layout Standard
Nestedness, defined as a non-random pattern of interactions where specialist
 species interact with proper subsets of more generalist species introduces
 the concept of 
\begin_inset Quotes eld
\end_inset

diffuse coevolution” in a more quantitative context 
\begin_inset CommandInset citation
LatexCommand citep
key "Bascompte-2003"

\end_inset

.
 Patterns of nestedness have been shown to provide information about the
 underlying network dynamics.
 For example, nestedness may be associated with stability and coexistence
 of species in mutualistic networks 
\begin_inset CommandInset citation
LatexCommand citep
key "Bastolla2009,Okuyama-2008"

\end_inset

, although these properties might be also independent of nestedness (Pitchford
 & Plank 2012).
\end_layout

\begin_layout Standard
Complementarity, trait matching between mutualistic partners (e.g.
 corolla length-proboscis length, frugivore body mass-seed size, 
\begin_inset CommandInset citation
LatexCommand citep
key "Bascompte-Jordano-2007"

\end_inset

) could be the product of reciprocal evolution (i.e.
 coevolution).
 In highly specialized two-species interactions, as for example the fig-fig
 wasp mutualism 
\begin_inset CommandInset citation
LatexCommand citep
key "Bronstein-2006"

\end_inset

, plants coevolve with their most efficient pollinator to strengthen the
 complementarity of their matching adaptations (i.e., coevolutionary selection).
 There are also situations where an insect will be unable to reach nectar
 in floral tubes longer than its proboscis: the tube length sets up a barrier
 to some species, but not to others.
 For example, combining rules that link plants to pollinators whose trait
 ranges overlap and rules that link pollinators to flowers whose traits
 are below a pollinator-specific barrier value seem to predict structural
 properties of empirical mutualistic networks 
\begin_inset CommandInset citation
LatexCommand citep
key "SantamariaRodriguez2007"

\end_inset

.
 Thus, developmental and morphological constraints may be required to explain
 complementarity 
\begin_inset CommandInset citation
LatexCommand citep
key "Bascompte-Jordano-2007,Andersonetal2010"

\end_inset

.
\end_layout

\begin_layout Standard
Convergence, the independent evolution of similar features in the same community
 in different evolutionary lineages is a common, perhaps a ubiquitous phenomenon
 but its interpretation is not clear-cut 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

.
 Selective and non-selective causes can produce evolutionary trait convergence
 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

.
 Traits may evolve according to the same environmental or biotic pressures
 in independent lineages or as Brownian motion with speciation occurring
 randomly 
\begin_inset CommandInset citation
LatexCommand citep
key "Stayton_2008"

\end_inset

.
 Evolutionary convergence in plant-animal mutualisms partly explains the
 formation of 'syndromes' produced by the presence of specific mutualist
 partner species 
\begin_inset CommandInset citation
LatexCommand citep
key "Waser_1996,Howe_1982,Bascompte-Jordano-2007"

\end_inset

.
 For example, plant species with a specific corolla morphology may determine
 the evolutionary convergence of pollinator species traits 
\begin_inset CommandInset citation
LatexCommand citep
key "Jousselin_2003,guimaraes_coevol_2011"

\end_inset

.
\end_layout

\begin_layout Standard
Recently, 
\begin_inset CommandInset citation
LatexCommand citet
key "guimaraes_coevol_2011"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

 explored evolutionary models using a broad range of coevolutionary selection
 values to study convergence and complementarity in mutualistic networks.
 
\begin_inset CommandInset citation
LatexCommand citet
key "guimaraes_coevol_2011"

\end_inset

 show that convergence in a one-dimensional trait within a trophic level
 may in part emerge as a consequence of selection for a complementarity
 trait between trophic levels.
 For weak or absent coevolutionary selection, 
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

 show that trait values in animal and plant species can be highly variable
 and non-convergent but positively correlated (i.e., complementary).
 As coevolutionary selection intensifies, variation in the trait values
 of animal and plant species is reduced and convergence emerges but correlations
 between traits of interacting species are weakened (i.e., low pairwise complement
arity).
 
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

 further explored the connection between convergence and complementarity
 to nestedness patterns in mutualistic networks.
 They showed that interactions mediated by a mechanism of phenotype matching
 tend to be antinested when coevolutionary selection is weak and become
 even more strongly antinested with increasing coevolutionary selection
 favoring the emergence of reciprocal specialization.
 Taken together, these results suggest that it is not trivial to explain
 simultaneously a high degree of convergence, complementarity and nestedness
 in species-rich mutualistic networks as observed the empirical data.
\end_layout

\begin_layout Standard
Difficulties in obtaining predictions of simultaneously large values of
 convergence, complementarity and nestedness in mutualistic networks may
 also be a consequence of unexplored drivers currently lacking in models
 of mutualistic networks.
 Most ecological models have focused on population dynamics to study nestedness
 while evolutionary models have focused on trait-based dynamics of interacting
 species, particularly the emergence of complementarity and convergence
 in the absence of population dynamics 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismer2004,KokkoLopezSepulcre2007,Bascompte-Jordano-2007,guimaraes_coevol_2011,Nuismeretal2012"

\end_inset

.
 However, demography and trait evolution may interact to produce feedbacks
 and eco-evolutionary dynamics (
\begin_inset CommandInset citation
LatexCommand citet
key "Schoener2011"

\end_inset

).
 Yet, eco-evolutionary spatial diversification models combining simultaneously
 population and trait dynamics to connect trait-based patterns as complementarit
y and convergence with nestedness in mutualistic networks are currently
 lacking.
 
\end_layout

\begin_layout Standard
Much work on diversification emphasizes on ecological divergence and speciation
 
\begin_inset CommandInset citation
LatexCommand citep
key "Schluter:2009,Doebeli_book,Seehausenetal_2014,Rainey_Travisano:1998,Butlin_Bridle_Schluter_2009,Gavrilets_Losos_2009"

\end_inset

, but we propose here to step back and ask basic questions about the dynamics
 of divergence in mutualistic networks, and how it may depend on sexual
 reproduction, spatial, genetic, morphological and demographic processes.
 Before we understand the full impact of adaptation, coevolutionary selection
 and ecological speciation on evolution and diversity in ecologically complex
 mutualistic networks, we need to understand well the basic dynamics of
 mutation, gene flow, drift, morphological and spatial constraints underlying
 the process of diversification in species-rich mutualistic networks.
 Thus, to further understand the trade-offs between convergence, complementarity
 and nestedness in mutualistic networks, diversification models accounting
 for phylogenetic relatedness combining demographic, morphological constraints
 and evolutionary processes of trait divergence and convergence in species-rich
 mutualistic networks are required.
 Here, we extend landscape genetics models of diversification dynamics that
 combine evolutionary forces (mutation, recombination and genetic drift,
 
\begin_inset CommandInset citation
LatexCommand citep
key "kimura,hubbell_book,Lynch_2007,Vellend2010"

\end_inset

) with demographic processes (migration, ecological drift, speciation and
 extinction, 
\begin_inset CommandInset citation
LatexCommand citep
key "Gavriletsetal2000,deaguiar_2009,melian_2012,Higgs_Derrida:1992"

\end_inset

) to connect quantitative trait dynamics in sexually reproducing plant and
 pollinator populations to convergence, complementarity and nesstedness
 in mutualistic networks.
\end_layout

\begin_layout Standard
We find that diversification dynamics change trait distributions, and patterns
 of convergence, complementarity, nestedness and connectance in mutualistic
 networks.
 We show that convergence and complementarity emerge together with high
 levels of nestedness in the absence of coevolutionary selection.
 Our model predcits that trait convergence occurs mostly between the common
 species and on average in approximately 
\begin_inset Formula $20\%$
\end_inset

 of all possible events while trait complementarity occurs in approximately
 
\begin_inset Formula $30\%$
\end_inset

 of all possible events.
 Our model predicts well plant-animal complementarity and convergence for
 animals but not for plants in a empirical plant-hummingbird mutualistic
 network.
 In contrast to previous studies where interactions mediated by a mechanism
 of phenotype matching tended to be antinested when coevolutionary selection
 was weak, we found that, in the absence of coevolutionary selection, highly
 nested values are obtained in agreement with the empirical mutualistic
 networks.
 Taken together our results suggest that diversification dynamics combining
 ecological (demography and dispersal limitation), population genetics (mutation
, recombination, assortative mating and drift) and morphological constraints
 associated to trait matching expand theoretical approaches to predict the
 key patterns of mutualistic networks, from trait convergence and complementarit
y to connectance and nestedness.
\end_layout

\begin_layout Section*

\size large
The model: Eco-evolutionary diversification in mutualistic networks
\end_layout

\begin_layout Standard
We consider a landscape consisting of several individual plants (
\emph on
P
\emph default
) and animal pollinators (
\emph on
A
\emph default
).
 Individuals belonging to these two communities interact mutualistically
 and we assume obligate mutualism for both partners.
 Furthermore, the number of individuals at each trophic level is fixed and
 equal to the environmental carrying capacity for the given community.
 Genetic, phenotypic and species composition change in time and space due
 to replacement of dead individuals by offspring of the same or another
 species (the key terms and model steps are summarized in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Recombination"

\end_inset

 and table 1, respectively).
 In this section we explain how we model population, diversification and
 trait dynamics.
\end_layout

\begin_layout Subsection*

\series medium
Population dynamics 
\end_layout

\begin_layout Standard
Our model is a stochastic individual-based model with overlapping generations.
 The population consists of 
\begin_inset Formula $J_{P}$
\end_inset

 and 
\begin_inset Formula $J_{A}$
\end_inset

 haploid gonochoric (i.e.
 separated sexes) individuals with an explicit genome of size 
\begin_inset Formula $L$
\end_inset

 each and equal sex ratios at the outset.
 The genome of each individual is composed by 
\begin_inset Formula $L-1$
\end_inset

 assortative mating loci and one neutral locus.
 Both plant and animal population reproduce sexually and are spatially structure
d.
 Demography follows by randomly selecting to die an individual plant 
\begin_inset Formula $k$
\end_inset

 and animal 
\begin_inset Formula $k'$
\end_inset

.
 There are four conditions for producing viable offspring for the plant
 and animals, concerning: 1) geography, 2) genetics, 3) obligate mutualism
 and 4) morphology: 
\end_layout

\begin_layout Enumerate
Geography: a female and a male individual within the plant and animal population
s are randomly chosen among all females and males within a distance 
\begin_inset Formula $d_{max}$
\end_inset

 of the dead plant 
\begin_inset Formula $k$
\end_inset

 and dead animal 
\begin_inset Formula $k'$
\end_inset

 .
 This requires two geographic distance matrices, one for plants, 
\begin_inset Formula $D^{P}$
\end_inset

 = [
\begin_inset Formula $d_{ij}^{P}$
\end_inset

], and one for animals, 
\begin_inset Formula $D^{A}$
\end_inset

 = [
\begin_inset Formula $d_{ij}^{A}$
\end_inset

], containing all the pairwise distances.
 
\end_layout

\begin_layout Enumerate
Genetics: to produce a viable offspring between the female and the male
 in the plant and animal populations, they must have a genetic similarity
 value of the assortative mating loci, 
\begin_inset Formula $q_{\venus\mars}$
\end_inset

, higher than the minimum genetic similarity to have viable offspring, 
\begin_inset Formula $q_{min}$
\end_inset

, (
\begin_inset Formula $q_{\venus\mars}>q_{min}$
\end_inset

).
 This process reflects assortative mating and it requires two genetic similarity
 matrices, one for plants, 
\begin_inset Formula $Q^{P}$
\end_inset

 = [
\begin_inset Formula $q_{ij}^{P}$
\end_inset

], and one for animals, 
\begin_inset Formula $Q^{A}$
\end_inset

 = [
\begin_inset Formula $q_{ij}^{A}$
\end_inset

], containing all the pairwise similarity values.
 
\end_layout

\begin_layout Enumerate
Obligate mutualism: that the geographic distance between the female 
\begin_inset Formula $\venus$
\end_inset

 (animal or plant) and one of the two male animal or plant individuals,
 represented here as 
\begin_inset Formula $j$
\end_inset

, is lower than the maximum distance, 
\begin_inset Formula $d_{max}^{PA}$
\end_inset

, (
\begin_inset Formula $d_{j\venus}^{PA}<d_{max}^{PA}$
\end_inset

).
 This requires one geographic distance matrix, 
\begin_inset Formula $D^{PA}$
\end_inset

 = [
\begin_inset Formula $d_{ij}^{PA}$
\end_inset

], containing all the pairwise distances.
 
\end_layout

\begin_layout Enumerate
Morphology: female plants need the presence of an animal pollinator with
 a larger or equally-sized proboscis than the corolla of the female plant,
 thus the phenotype of the selected pollinator, represented here as 
\begin_inset Formula $j$
\end_inset

, must satisfy 
\begin_inset Formula $z_{\venus}^{P}\leq z_{j}^{A}$
\end_inset

.
 This requires two phenotype distributions, one for the plants, 
\begin_inset Formula $Z^{P}=[z_{i}^{P}]$
\end_inset

 and one for the animals, 
\begin_inset Formula $Z^{A}=[z_{i}^{A}]$
\end_inset

.
 This mechanism is similar to the the 
\begin_inset Quotes eld
\end_inset

phenotypic difference
\begin_inset Quotes erd
\end_inset

 mechanism assumed in the model of 
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

.
 
\end_layout

\begin_layout Standard
The offspring arising from this mating event will occupy the geographic
 position of the just deceased individual.
\end_layout

\begin_layout Subsection*

\series medium
Diversification dynamics
\end_layout

\begin_layout Standard
To quantify speciation events we calculate the genetic distance between
 each pair of individuals based on the assortative mating loci.
 We represent the genome of each individual by a sequence of 
\begin_inset Formula $L-1$
\end_inset

 loci, where each locus can be in two allelic states, 
\begin_inset Formula $+1$
\end_inset

 or 
\begin_inset Formula $-1$
\end_inset

.
 The assortative mating loci of each plant individual 
\begin_inset Formula $i$
\end_inset

 in a population of size 
\begin_inset Formula $J_{P}$
\end_inset

 is represented as a vector: 
\begin_inset Formula $S^{i}=(S_{1}^{i},S_{2}^{i},...,S_{L}^{i})$
\end_inset

, where 
\begin_inset Formula $S_{u}^{i}$
\end_inset

 is the 
\begin_inset Formula $u^{th}$
\end_inset

 locus of individual 
\begin_inset Formula $i$
\end_inset

.
 The genetic similarity based on assortatove mating loci between individuals
 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 is calculated as the sum of identical loci across the genome
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
q_{ij}^{P}=\frac{1}{L}\sum_{u=1}^{L}S_{u}^{i}S_{u}^{j}\label{eq:genetic_similarity}
\end{equation}

\end_inset

where 
\begin_inset Formula $q_{ij}^{P}\in\{-1,1\}$
\end_inset

 with the genetic similarity matrix, 
\begin_inset Formula $Q^{P}$
\end_inset

 = [
\begin_inset Formula $q_{ij}^{P}$
\end_inset

], containing all pairwise genetic similarity values for plants (the same
 for animals, 
\begin_inset Formula $Q^{A}$
\end_inset

 = [
\begin_inset Formula $q_{ij}^{A}$
\end_inset

]).
 The genome of the offspring is obtained by a block cross-over recombination
 of a female genome, 
\begin_inset Formula $S^{\venus}$
\end_inset

, and a male genome, 
\begin_inset Formula $S^{\mars}$
\end_inset

, where a locus 
\begin_inset Formula $l$
\end_inset

 in the genome of the parents is randomly chosen partitioning the genome
 of each individual in two blocks.
 All genes beyond that locus 
\begin_inset Formula $l$
\end_inset

 in either genome are swapped between the two parents and eventually form
 two new genomes.
 One of the two new genomes is randomly chosen for the offspring.
 The offspring's genome undergoes mutations at mutation rate 
\begin_inset Formula $\mu$
\end_inset

.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Recombination"

\end_inset

 describes the recombination-mutation process.
\end_layout

\begin_layout Standard
At the beginning of the simulations all individuals are genetically identical
 (all 
\begin_inset Formula $q_{ij}^{P}$
\end_inset

 and 
\begin_inset Formula $q_{ij}^{A}$
\end_inset

 = 1); hence they are all able to mate and produce viable offspring.
 The genetic similarity between individuals of a guild can be visualized
 as an evolutionary spatial graph 
\begin_inset CommandInset citation
LatexCommand citep
key "melian2010_plos"

\end_inset

, where nodes correspond to individuals and the edges correspond to the
 geographic distances between a pair of individuals satisfying the genetic
 similarity condition for mating, 
\begin_inset Formula $q_{ij}^{P}(q_{ij}^{A})>q_{min}$
\end_inset

.
 The connectance of the graph will decrease when generations move forward
 because of the processes described in the previous section: 1) spatial
 constraints for mating driving assortative mating and dispersal limitation;
 2) genetic divergence driven by the threshold for mating (incompatibilities),
 mutation and recombination forming the genome of the offspring; 3) obligate
 mutualistic interactions driven by spatial proximity of individuals of
 the other guild, and 4) morphological constraints.
\end_layout

\begin_layout Standard
These four set of processes drive genetic divergence and speciation.
 We followed the species definition of 
\begin_inset CommandInset citation
LatexCommand citet
key "Nei1983"

\end_inset

, which states that species are groups of individuals that are reproductively
 isolated and can interbreed to produce fertile offspring.
 In our model this is realized through allowing two individuals to mate
 successfully if their genetic similarity value is larger or equal to the
 minimum value, 
\begin_inset Formula $q_{min}$
\end_inset

.
 Thus, speciation is defined as a group of genetically related individuals,
 where two individuals in a sexual population can be conspecific while also
 being incompatible, as long as they can exchange genes indirectly through
 other conspecifics 
\begin_inset CommandInset citation
LatexCommand citep
key "deaguiar_2009,melian2010_plos"

\end_inset

.
 This is the definition of 'ring species' 
\begin_inset CommandInset citation
LatexCommand citep
key "MoritzSchneider1992"

\end_inset

.
\end_layout

\begin_layout Standard
Genetic divergence will eventually produce the formation of two genetically
 incompatible clusters of individuals, i.e.
 two species.
 This speciation process, also called 'fission-induced' speciation, continues
 to form more clusters and genetic divergence between individuals of different
 species increases.
 However, the diversification dynamics will fluctuate due to random extinctions
 (death of last individual of a species).
 A stochastic balance between speciation and extinction is eventually reached
 giving the final steady-state of the metacommunity.
\end_layout

\begin_layout Subsection*

\series medium
Quantitative trait dynamics
\end_layout

\begin_layout Standard
We model each individual plant and animal with a quantitative trait, 
\begin_inset Formula $z^{P}$
\end_inset

 and 
\begin_inset Formula $z^{A}$
\end_inset

, respectively.
 The processes described in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Recombination"

\end_inset

 govern two quantitative traits, one for each guild: proboscis or bill length
 (
\begin_inset Formula $z_{i}^{A}$
\end_inset

) in pollinators and corolla length (
\begin_inset Formula $z_{i}^{P})$
\end_inset

 in plants.
 The quantitative trait of offspring is determined by the additive genetic
 effects of the genome (i.e.
 no epistasis) after the process of randomly choosing one of the new two
 genomes and mutation (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Recombination"

\end_inset

) plus a normally distributed environmental effect, 
\begin_inset Formula $\epsilon$
\end_inset

, 
\begin_inset Formula $\mathcal{N}(\mu_{\epsilon}=0,\sigma_{\epsilon}^{2}=1$
\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "guimaraes_coevol_2011"

\end_inset

.
 The phenotype of the plant offspring 
\begin_inset Formula $i$
\end_inset

 is 
\begin_inset Formula $z_{i}^{P}=g_{i}^{P}+\epsilon$
\end_inset

 and the genetic component (
\begin_inset Formula $g_{i}^{P}$
\end_inset

) of the phenotype of offspring 
\begin_inset Formula $i$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g_{i}^{P}=L+S_{o}^{i}\label{eq:genetic_comp}
\end{equation}

\end_inset

with 
\begin_inset Formula $S_{o}^{i}=\sum_{u=1}^{L}S_{u}^{i}$
\end_inset

.
 Hence 
\begin_inset Formula $g_{i}^{P}$
\end_inset

 is calculated as the sum of alleles across the genome 
\begin_inset CommandInset citation
LatexCommand citep
key "kondrashov_shpak_1998"

\end_inset

 plus the number of loci to avoid negative trait values (
\begin_inset Formula $g_{i}^{A}$
\end_inset

 is calculated similarly for animals).
 We assumed that the magnitude of the influence (i.e., effect sizes) of any
 given locus on this quantitative trait is equal across all the loci 
\begin_inset CommandInset citation
LatexCommand citep
key "Seehausenetal_2014"

\end_inset

.
 This means that two individuals with a different combination of alleles
 in the genome can express the same quantitative trait 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

.
\end_layout

\begin_layout Subsection*

\series medium
Neutral locus evolution
\end_layout

\begin_layout Standard
We considered a neutral locus to estimate genetic divergence among species
 for the calculation of convergent events (see section 
\begin_inset Quotes eld
\end_inset

Evolutionary convergence
\begin_inset Quotes erd
\end_inset

).
 The neutral locus is located at the end of the genome at the position 
\begin_inset Formula $L$
\end_inset

 and has 
\begin_inset Formula $k$
\end_inset

 possible allelic states.
 The locus is completely unlinked from the rest of the genome that contains
 the assortative mating loci.
 We used low mutation rates for this neutral locus, 
\begin_inset Formula $\mu_{neutral}=10^{-7}$
\end_inset

 , and the 
\begin_inset Formula $k$
\end_inset

 allele mutation model (i.e.
 model in which each allele can mutate to any of the other 
\begin_inset Formula $k–1$
\end_inset

 possible alleles with equal probability (
\begin_inset CommandInset citation
LatexCommand citet
key "Hobanetal2013"

\end_inset

).
 We used the Cavalli-Sforza distance to calculate the matrix of genetic
 distances among species (
\begin_inset CommandInset citation
LatexCommand citet
key "CavalliEdwards1967"

\end_inset

).
\end_layout

\begin_layout Section*

\size large
Convergence, complementarity and nestedness
\end_layout

\begin_layout Subsection*

\series medium
Evolutionary convergence
\end_layout

\begin_layout Standard
The calculation of convergence requires computing pairwise genotypic and
 phenotypic similarities and the similarity between mean species phenotypes
 from distantly related species.
 With only three species, only one convergence is possible after excluding
 the sister species (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Evolutionary-convergence"

\end_inset

).
 The number of convergences potentially increases with the number of species
 present.
 For example, if we have ten species and we exclude one of them as the sister
 species of the focal species, we have nine species to calculate convergence.
 If we find that two out of nine species are phenotypically similar enough
 to the focal species, we count two (out of nine,
\begin_inset Formula $\sim22\%$
\end_inset

) convergences.
 We repeat this by changing the focal species and calculate the mean convergence
 events over all species.
 In contrast to previous approaches that used the mean pair-wise difference
 between traits of species 
\begin_inset CommandInset citation
LatexCommand citep
key "guimaraes_coevol_2011"

\end_inset

 or the variance of species traits in a guild as a proxy to predict convergence
 (i.e., large values weak convergence whereas small values of the variance
 may indicate strong convergence, 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismeretal2012"

\end_inset

), we used the relationship between genetic divergence and phylogenetic
 relatedness for the estimation of evolutionary convergences.
 The advantage of our method considering phylogenetic relatedness is that
 it excludes cases of development of very similar trait values from sister
 species (i.e., parallel evolution, 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

) and therefore it does not overestimate convergence events.
 Finally, to visualize the genetic relatedness between species we constructed
 clustering trees using Euclidean distance with the Python library ETE 2.01
 
\begin_inset CommandInset citation
LatexCommand citep
key "ete_python"

\end_inset

).
\end_layout

\begin_layout Subsubsection*

\series medium
Phenotypic similarity
\end_layout

\begin_layout Standard
The phenotypic similarity for plants (
\begin_inset Formula $p_{ij}^{P}$
\end_inset

) between individual 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 is defined as 
\begin_inset Formula 
\begin{equation}
p_{ij}^{P}=1-\frac{|z_{i}^{P}-z_{j}^{P}|}{z_{max}^{P}}\label{eq:phenotypic_sim}
\end{equation}

\end_inset

where 
\begin_inset Formula $z_{i}^{P}$
\end_inset

 and 
\begin_inset Formula $z_{j}^{P}$
\end_inset

 are the phenotypic similarity values of 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

, respectively, and 
\begin_inset Formula $z_{max}^{P}$
\end_inset

 is the maximum value of the phenotype distribution, 
\begin_inset Formula $Z^{P}$
\end_inset

 .
 Thus, the elements 
\begin_inset Formula $p_{ij}^{P}\in\{0,1\}$
\end_inset

 of the phenotypic similarity matrix, 
\begin_inset Formula $\mathcal{P}^{P}$
\end_inset

 = [
\begin_inset Formula $p_{ij}^{P}$
\end_inset

] represent all pairwise values for plants (the same for animals, 
\begin_inset Formula $\mathcal{P}^{A}$
\end_inset

 = [
\begin_inset Formula $p_{ij}^{A}$
\end_inset

]).
\end_layout

\begin_layout Subsubsection*

\series medium
Mean genetic and phenotypic species similarity
\end_layout

\begin_layout Standard
We define evolutionary convergence as the similarity between average species
 phenotypes from distantly related species.
 We assume that two species are distantly related, in phylogenetic terms,
 if they do not come from a direct common ancestor, i.e.
 they are not sister species.
 To exclude sister species from the analysis we need to calculate the mean
 genetic similarity among species of the same guild.
 The mean genetic similarity between a plant species 
\begin_inset Formula $k$
\end_inset

 and a plant species 
\begin_inset Formula $l$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{q}_{kl}^{P}=\frac{1}{n_{k}n_{l}}\sum_{i=1}^{n_{k}}\sum_{j=i}^{n_{l}}q_{ij}^{P}\label{eq:genetic_sim_species}
\end{equation}

\end_inset

where 
\begin_inset Formula $q_{ij}^{P}$
\end_inset

 is the genetic similarity between an individual 
\begin_inset Formula $i$
\end_inset

 of plant species 
\begin_inset Formula $k$
\end_inset

 and an individual 
\begin_inset Formula $j$
\end_inset

 of plant species 
\begin_inset Formula $l$
\end_inset

, and 
\begin_inset Formula $n_{k}$
\end_inset

 and 
\begin_inset Formula $n_{l}$
\end_inset

 are the absolute abundances of plant species 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $l$
\end_inset

, respectively.
 The elements 
\begin_inset Formula $\hat{q}_{kl}^{P}$
\end_inset

 form the matrix 
\begin_inset Formula $Q_{s}^{P}=[\hat{q}_{kl}^{P}]$
\end_inset

 from which the sister species of each species in the guild can be identified
 (The elements for animals, 
\begin_inset Formula $Q_{s}^{A}=[\hat{q}_{kl}^{A}]$
\end_inset

, are calculated in the same way as we did for the plants).
 To calculate evolutionary convergence we need to know the average phenotypic
 similarity between two species.
 We define phenotypic similarity between species 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $l$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{p}_{kl}^{P}=\frac{1}{n_{k}n_{l}}\sum_{i=1}^{n_{k}}\sum_{j=i}^{n_{l}}p_{ij}^{P}\label{eq:phenotypic_sim_species}
\end{equation}

\end_inset

which is analogous to the definition of eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:genetic_sim_species"

\end_inset

, but now considering phenotypes instead of genotypes.
 This will build a species phenotypic similarity matrix 
\begin_inset Formula $P_{s}^{P}=[\hat{p}_{kl}^{P}]$
\end_inset

 (the species phenotypic similarity matrix, 
\begin_inset Formula $P_{s}^{A}=[\hat{p}_{kl}^{A}]$
\end_inset

, is calculated analogously for the animals).
 We then focus on each species in turn and exclude its sister species to
 avoid cases of parallel evolution to calculate the number of convergences
 related to the focal species.
 We define a focal plant species 
\begin_inset Formula $k$
\end_inset

 and a non-sister plant species 
\begin_inset Formula $l$
\end_inset

 to be convergent if phenotypic similarity between them is higher than between
 focal and sister species (
\begin_inset Formula $\hat{p}_{k,sister}^{P}<\hat{p}_{kl}^{P}$
\end_inset

) and higher than a certain phenotypic threshold value 
\begin_inset Formula $t_{conv}$
\end_inset

 (
\begin_inset Formula $\hat{p}_{kl}^{P}>t_{conv})$
\end_inset

; convergent species is calculated analogously for the animals).
\end_layout

\begin_layout Subsection*

\series medium
Evolutionary complementarity
\end_layout

\begin_layout Standard
Evolutionary complementarity does not require the genetic similarity matrix.
 We only need to estimate the phenotypic similarity between plant and animal
 species and we do this as we did for the evolutionary convergence.
 We calculate the phenotypic similarity matrix 
\begin_inset Formula $P_{s}^{PA}=[\hat{p}_{kh}^{PA}]$
\end_inset

.
 This matrix contains the mean trait similarity for each plant species 
\begin_inset Formula $k$
\end_inset

 and animal species 
\begin_inset Formula $h$
\end_inset

.
 The condition for complementarity is that the similarity between a plant
 species 
\begin_inset Formula $k$
\end_inset

 and an animal species 
\begin_inset Formula $h$
\end_inset

 is 
\begin_inset Formula $\hat{p}_{kh}^{PA}>t_{comp}$
\end_inset

, where 
\begin_inset Formula $t_{comp}$
\end_inset

 is the phenotypic threshold value to detect a complementarity event.
\end_layout

\begin_layout Subsubsection*

\series medium
Plant-animal interactions
\end_layout

\begin_layout Standard
In addition to the genetic and geographic constraints for mating, we consider
 two other conditions for plants and animals: obligate mutualism and morphologic
al constraints.
 Obligate mutualism applies to the plants and animals to reproduce but the
 morphological constraints only apply to plants.
 We therefore need a geographic distance matrix, 
\begin_inset Formula $D^{PA}$
\end_inset

, to describe the geographic distance between plant and animal individuals.
 Plant-animal mutualistic interactions are here described as follows: plants
 benefit from the presence of specific pollinators that are able to pollinate
 them and animals benefit from the presence of plants that provide resources
 for them.
 Thus, we have two extra conditions for mating: 
\end_layout

\begin_layout Enumerate
Female plants need the presence of an animal pollinator (i.e., male and female
 represented as 
\begin_inset Formula $j$
\end_inset

) within a close distance, 
\begin_inset Formula $d_{j\venus}^{PA}<d_{max}^{PA}$
\end_inset

.
 The pollinator must have a larger or equally-sized proboscis than the corolla
 of a plant, 
\begin_inset Formula $z_{\venus}^{P}\leq z_{j}^{A}$
\end_inset

.
 This corresponds to a morphological constraint for individual interactions
 observed between plant and pollinator species 
\begin_inset CommandInset citation
LatexCommand citep
key "stang_2009_annbot,Stang_2006"

\end_inset

.
 
\end_layout

\begin_layout Enumerate
Animals need the presence of a plant (male or female represented as 
\begin_inset Formula $j$
\end_inset

) within a close geographic distance, 
\begin_inset Formula $d_{jk}^{PA}<d_{max}^{PA}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Our model allows bookkeeping of who is interacting with whom, i.e.
 this means we can record exactly which plant and animal individuals are
 interacting.
 This bookkeeping enables us to identify the consequences of geography,
 genetics, obligate mutualism and morphology for the evolution and final
 topology of the network.
 We record the identity of the mutualistic partners during the reproduction
 process for plants and animals after reaching the steady-state to reconstruct
 the plant-animal interaction network.
\end_layout

\begin_layout Subsection*

\series medium
Nestedness and connectance
\end_layout

\begin_layout Standard
To study the connection between convergence and complementarity with network
 properties, we measured two topological properties of plant-animal mutualistic
 networks: nestedness and connectance.
 We estimated nestedness using the NODF algorithm developed by 
\begin_inset CommandInset citation
LatexCommand citep
key "Almeida-neto_nodf"

\end_inset

 because of its statistical robustness.
 NODF is based on standardized differences in row and column fills and paired
 matching of occurrences.
 Connectance measures the proportion of realized interactions among all
 possible interactions in a network.
 It is defined as 
\begin_inset Formula $C=\frac{k}{P*A}$
\end_inset

, where 
\begin_inset Formula $k$
\end_inset

 represents the number of realized interactions between plant and animal
 species and 
\begin_inset Formula $P$
\end_inset

 and 
\begin_inset Formula $A$
\end_inset

 represent the number of plant and animal species in the network, respectively
 
\begin_inset CommandInset citation
LatexCommand citep
key "Jordano-2003"

\end_inset

.
\end_layout

\begin_layout Section*

\size large
Simulations
\end_layout

\begin_layout Standard
We simulated equal population sizes for plants and animals with 
\begin_inset Formula $J^{P}=J^{A}=1,000$
\end_inset

 individuals.
 Genome size, 
\begin_inset Formula $L$
\end_inset

, of each individual was 150 loci.
 Initial trait distributions for the plants, 
\begin_inset Formula $Z^{P}=[z_{i}^{P}]$
\end_inset

 and animals, 
\begin_inset Formula $Z^{A}=[z_{i}^{A}]$
\end_inset

, were generated following equation 2 plus a normally distributed environmental
 effect, 
\begin_inset Formula $\epsilon$
\end_inset

, 
\begin_inset Formula $\mathcal{N}(\mu_{\epsilon}=0,\sigma_{\epsilon}^{2}=1$
\end_inset

).
 To ensure plant mating conditions are met at the beginning of the simulation
 all animal individuals have a higher phenotypic trait value that the plant
 individuals.
\end_layout

\begin_layout Standard
Geographic distances between each pair of individuals 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 for the plants, 
\begin_inset Formula $d_{ij}^{P}$
\end_inset

, and animals, 
\begin_inset Formula $d_{ij}^{A}$
\end_inset

, were calculated as follows: 1) Euclidean coordinates of a two-dimensional
 space (
\begin_inset Formula $x_{i},y_{i}$
\end_inset

) were sampled from a uniform distribution (
\begin_inset Formula $x_{i}=[0,1],y_{i}=[0,1]$
\end_inset

) for each individual for the plants and animals; 2) Using these coordinates
 we calculated a matrix of relative Euclidean distances between the individuals
 for the plants, 
\begin_inset Formula $d_{ij}^{P}$
\end_inset

, and animals, 
\begin_inset Formula $d_{ij}^{A}$
\end_inset

.
 This procedure was repeated for each of the geographic distance matrices
 (
\begin_inset Formula $D^{PA},D^{P},D^{A}$
\end_inset

).
\end_layout

\begin_layout Standard
We ran 2,000 generations for each replicate for a total of 500 replicates,
 where a generation is the update of the effective population size (
\begin_inset Formula $J^{P}=J^{A}=1,000$
\end_inset

), i.e.
 the number of steps equal to the effective population size.
 Steady-state was verified by checking the constancy of speciation events
 during the last 
\begin_inset Formula $100$
\end_inset

 generations.
 We calculated convergence, complementarity, nestedness and connectance
 at steady-state.
 Convergence and complementarity events were calculated for a whole range
 (
\begin_inset Formula $[0.0,1.0]$
\end_inset

) of their respective thresholds, 
\begin_inset Formula $t_{conv}$
\end_inset

 and 
\begin_inset Formula $t_{comp}$
\end_inset

.
 We explored parameter combinations with mutation rate, 
\begin_inset Formula $\mu\in\{10^{-4},10^{-2}\}$
\end_inset

, minimum genetic similarity, 
\begin_inset Formula $q_{min}=0.97$
\end_inset

, maximum distance for finding a mate and disperse, 
\begin_inset Formula $d_{max}\in\{0.1,0.3\}$
\end_inset

, and a maximum geographic distance to find a mutualistic partner, 
\begin_inset Formula $d_{max}^{PA}=0.3$
\end_inset

.
 We implemented the model in Python (and tested in IPython 
\begin_inset CommandInset citation
LatexCommand citep
key "ipython"

\end_inset

).
 Plots were produced using the Python library Matplotlib 
\begin_inset CommandInset citation
LatexCommand citep
key "matplotlib"

\end_inset

.
\end_layout

\begin_layout Section*

\size large
Model-data fitting
\end_layout

\begin_layout Standard
We test our model's predictions of convergence and complementarity using
 a dataset of a plant-hummingbird network containing morphological and phylogene
tic data (
\begin_inset CommandInset citation
LatexCommand citet
key "Maglianesi_2014"

\end_inset

).
 We used empirical values of corolla length and bill length from plants
 and hummingbirds, respectively.
 To calculate convergence with this empirical dataset we also considered
 the phylogenetic relationships among species.
 We used a well resolved phylogeny of hummingbirds from 
\begin_inset CommandInset citation
LatexCommand citet
key "McGuire_2007"

\end_inset

.
 We used 24 hummingbird species from a total of 38, which were not present
 in the phylogenetic tree.
 For the plant species we constructed a phylogenetic tree using genetic
 data of 69 species from genBANK and calculate a ML tree using RAXML .
 We excluded 64 plant species from the analysis (see Suppl.
 Materials) because their phylogenetic relationships were not well resolved
 (polytomies), leaving a total of 69 species from a total of 133 from the
 dataset of Maglianesi et al (2014).
 We used the R package APE 
\begin_inset CommandInset citation
LatexCommand citep
key "APE_rpackage"

\end_inset

 in R 
\begin_inset CommandInset citation
LatexCommand citep
key "R_CRAN"

\end_inset

 to visualize and prune the tips (species) that were not used in our anlaysis
 (see Suppl.
 Materials)
\end_layout

\begin_layout Standard
We used the phylogenetic trees with their respective branch lengths to calculate
 a genetic distance matrix among species.
 Using both phylogenetic tress (hummingbirds and plants) we simulated nucleotide
 sequences of 100bp with the program SeqGen 
\emph on

\begin_inset CommandInset citation
LatexCommand citep
key "SeqGen_R_package"

\end_inset


\emph default
 following the Juke-Cantor model of molecular evolution.
 These simulated sequences were then used to calculate the genetic distance
 matrix using the R package 
\emph on
seqinr 
\emph default
in R 
\begin_inset CommandInset citation
LatexCommand citep
key "R_CRAN"

\end_inset

.
 To compare the convergence values obtained from the empirical data with
 our model predictions, we generated 1000 replicates from the simulations
 (bootstrapping) with each replicate containing the same number of plant
 and animal species as the empirical data.
 Mean values as well 0.05 and 0.95 CI were generated from these 1000 replicates.
 Complementarity and convergence were calculated for each of the replicates
 across the whole range of convergence, 
\begin_inset Formula $t_{conv}$
\end_inset

, and complementarity, 
\begin_inset Formula $t_{comp}$
\end_inset

, thresholds.
 In the absence of simulated phenotypic data for extinct species we could
 not calculate together the most recent common ancestor and phenotypic values
 to estimate convergence following metrics by 
\begin_inset CommandInset citation
LatexCommand citet
key "Stayton_2015"

\end_inset

.
 Instead, results presented in figure 7 for convergence events were calculated
 assuming a conservative estimation meaning the 30% of the most genetically
 similar species and not only the sister species to the focal species were
 excluded.
\end_layout

\begin_layout Section*

\size large
Results
\end_layout

\begin_layout Standard
Population dynamics and diversification dynamics changed plant and animal
 community trait distributions (i.e.
 corolla and proboscis lengths) with bimodal distributions being the most
 commonly produced patterns across replicates (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Changes-in-trait"

\end_inset

).
 At species level, a gradient of species phenotypes with common species
 presenting lower mean and higher variance than rare species emerged.
 Mean and variance of the trait values were correlated for most replicates
 (Spearman-
\begin_inset Formula $\rho$
\end_inset

 > 0.41, p < 0.05) and the distributions of abundance for plant or animal
 species were highly skewed and significantly different from a normal distributi
on (Lilliefors's test, all p < 0.001).
 Abundance predicted plant or animal mean species traits in approximately
 70
\begin_inset Formula $\%$
\end_inset

 of the replicates (Spearman-
\begin_inset Formula $\rho$
\end_inset

 > 0.32, p < 0.05) and trait variance for all replicates (0.39 < Spearman-
\begin_inset Formula $\rho$
\end_inset

 < 0.79, all p < 0.05).
 Mean and variance of species trait values significantly differed between
 common and rare plant or animal species (inset in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Changes-in-trait"

\end_inset

) suggesting a strong impact of diversification by producing a gradient
 of species phenotypes in mutualistic networks.
\end_layout

\begin_layout Standard
Evolutionary convergence events occurred in all replicate simulations (see
 equations 4 and 5 with an example of evolutionary convergence events in
 animals and plants represented in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:convergence-complementarity"

\end_inset

).
 Convergence events were heterogeneously distributed across species with
 most events occurring between common species (0.42 < Spearman-
\begin_inset Formula $\rho$
\end_inset

 < 0.89, all p < 0.05).
 Evolutionary convergence occurred on average in 
\begin_inset Formula $17.3\pm6\%$
\end_inset

 of all possible convergence events with more than 95% of these events occurring
 within the three most common species.
 These results show that evolutionary convergence is not randomly distributed
 across pairs of species but highly aggregated during the diversification
 process.
 Evolutionary convergence can also be visualized using a scatter plot of
 the genotype-phenotype map for all pairs of individuals within the plant
 and animal communities (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Genotype-phenotype-relationship-"

\end_inset

).
 As expected from equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:genetic_comp"

\end_inset

, there is a positive genotype-phenotype relationship.
 The scatter plot contains three main clouds of points that consistently
 occur in our simulations for the plants, 
\emph on
P
\emph default
, and animals, 
\emph on
A
\emph default
: 1) pairs of individuals of the same species with high genetic (
\begin_inset Formula $q_{ij}>q_{min}$
\end_inset

) and phenotypic (
\begin_inset Formula $p_{ij}>0.9$
\end_inset

) similarity, 2) pairs of individuals of the same species with genetic similarit
y below 
\begin_inset Formula $q_{min}$
\end_inset

 (
\begin_inset Formula $q_{ij}<q_{min}=0.97$
\end_inset

) and high phenotypic similarity (
\begin_inset Formula $p_{ij}>0.9$
\end_inset

).
 These are incompatible individuals for mating, yet with high phenotypic
 similarity, 
\begin_inset Formula $p_{ij}>0.9$
\end_inset

, and 3) highly genetically dissimilar individuals from different species,
 
\begin_inset Formula $q_{ij}\ll q_{min}$
\end_inset

, but with the presence of highly phenotypically similar individuals (
\begin_inset Formula $p_{ij}>0.9$
\end_inset

).
 This last category shows evidence of evolutionary convergence between species
 in plants and animals.
 An increase in mutation rate increases the genetic divergence between species,
 as expected, but it does not change the genotype-phenotype relationship
 qualitatively (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Genotype-phenotype-relationship-"

\end_inset

).
\end_layout

\begin_layout Standard
Evolutionary complementarity occurred with a similar frequency as evolutionary
 convergence in each replicate (see equation 5 and compare the initial with
 the final trait distributions in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Changes-in-trait"

\end_inset

), but with a larger variation (
\begin_inset Formula $20\pm18\%$
\end_inset

).
 Connectance values were consistently medium or high (
\begin_inset Formula $\overline{C}=0.5\pm0.07$
\end_inset

, figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:nestedness"

\end_inset

), mostly larger than reported in empirical data where it ranges between
 0.05-0.25.
 Nestedness values were always high (
\begin_inset Formula $\overline{N}=69.97\pm13.4$
\end_inset

 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:nestedness"

\end_inset

)), as observed in the empirical plant-pollinator networks.
 Convergence, complementarity and nestedness did not show signs of trade-offs
 and were uncorrelated across all replicates (0.08 < Spearman-
\begin_inset Formula $\rho$
\end_inset

 < 0.27, all p > 0.1) with the exception of a positive correlation between
 trait complementarity and evolutionary convergence in the plant community
 (Spearman-
\begin_inset Formula $\rho$
\end_inset

 = 0.61, all p < 0.05).
 Our results, using phylogenetically relatedness and phenotypic similarity
 for the estimation of evolutionary convergence and complementarity in the
 absence of coevolutionary selection, show evolutionary trait convergence
 and complementarity in all our replicate simulations but with little and
 large variation, respectively.
 For weak or absent coevolutionary selection, trait convergence in plant
 and animal communities is largely independent or positively correlated
 with trait complementarity for the animal and plant community, respectively.
 Our predictions consistently show low to medium convergence and complementarity
 together with high levels of nestedness in the absence of coevolutionary
 selection and convergence-complementarity trade-offs.
\end_layout

\begin_layout Standard
Our model predicts well plant-animal complementarity and convergence for
 animals but not for plants in a empirical plant-hummingbird mutualistic
 network (figure 7).
 The observed proportion of complementarity events for the empirical plant-hummi
ngbird data is within the CI for a broad range of values of the complementarity
 threshold, 
\begin_inset Formula $t_{comp}$
\end_inset

 (figure 7a).
 Our model consistently predict higher proportion of convergence events
 than the observed proportion in the plant community (figure 7b).
 Predictions in the proportion of convergent events quickly increase for
 a high convergence threshold value (red lines figure 7b) and saturates
 around the same observed values for medium and low convergent threshold
 values.
 These results suggest that in the absence of coevolutionary selection among
 plants and hummingbirds our model predicts higher proportion of convergence
 events than the observed number in the plant community.
 Predictions of the proportion of convergence events for the hummingbird
 community are within the estimated CI for all the range of convergence
 threshold values (figure 7c).
 These results show that predictions for plant-animal complementarity and
 convergence in the hummingbird community are robust against a broad range
 of threshold values suggesting that there is not need to invoke coevolutionary
 selection to predict these observed patterns.
 
\end_layout

\begin_layout Section*

\size large
Discussion
\end_layout

\begin_layout Standard
In the present study, we have extended previous landscape genetics models
 
\begin_inset CommandInset citation
LatexCommand citep
key "deaguiar_2009,melian_2012"

\end_inset

 to connect population and diversification dynamics with quantitative trait
 dynamics to study trait complementarity, convergence and nestedness in
 species-rich mutualistic networks.
 Our results show high levels of nestedness combined with low to medium
 levels of convergence and complementarity after controlling for phylogenetic
 relatedness (figure 2).
 This partly deviates from the simultaneously high levels of nestedness,
 convergence and complementarity observed in empirical data across a broad
 range of biogeographic regions 
\begin_inset CommandInset citation
LatexCommand citep
key "Bascompte-Jordano-2007"

\end_inset

.
 After controlling for phylogenetic relatedness and phenotypic similarity,
 we show that evolutionary trait convergence is observed in all our replicates
 with little variation (
\begin_inset Formula $17.3\pm6\%$
\end_inset

) and it is heterogeneously distributed across species with most events
 occurring between the common species.
 This suggests that evolutionary convergence is not randomly originated
 across pairs of species but highly aggregated during the diversification
 process.
 Similarly, complementarity is consistently observed but with a larger variation
 than convergence 
\begin_inset Formula $20\pm18\%$
\end_inset

.
 Our analysis suggests that convergence, complementarity and nestedness
 do not necessarily have to show signs of trade-offs in the absence of coevoluti
onary selection.
 Our results also show predictions that match the observed plant-animal
 complementarity and convergence for animals but not for plants in a empirical
 plant-hummingbird mutualistic network.
 These results suggest that weak or absent coevolutionary selection may
 reproduce the observed patterns of convergence in the hummingbird community
 analyzed here.
 We predict higher proportion of convergent events than the observed proportion
 in the plant community and we would expect even stronger deviations under
 strong coevolutionary selection because it tends to predict higher proportion
 of convergence events than weal coevolutionary selection.
 This means there is a need to invoke additional mechanisms to explain the
 observed patterns of convergence in the plant community here explored.
 
\end_layout

\begin_layout Standard
Previous studies have argued that evolutionary convergence is the product
 of multispecific coevolutionary processes ('diffuse coevolution')
\begin_inset CommandInset citation
LatexCommand citep
key "Janzen_coevolution_1980,Thompson-2002,Jordano-2003,Bascompte-Jordano-2007"

\end_inset

 and therefore convergence events are molded by similar ecological (or niche)
 selective pressures.
 Recent mutualistic coevolutionary models assuming the mechanism of 'phenotypic
 difference' (as our model) have shown that for weak or absent coevolutionary
 selection trait values in animal and plant species can be highly variable
 and non-convergent, but trait values of animal and plants species show
 high complementarity (i.e.
 they are positively correlated) 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismeretal2012"

\end_inset

.
 As coevolutionary selection intensifies, variation in the trait values
 of animal and plant species is reduced and convergence increases, but correlati
ons between traits of interacting species are weakened (i.e., low pairwise
 complementarity).
 However, 
\begin_inset CommandInset citation
LatexCommand citet
key "guimaraes_coevol_2011"

\end_inset

 have shown that trait convergence may in part emerge as a consequence of
 selection for a complementarity trait between the plants and animals.
 These approaches used all the species 
\begin_inset CommandInset citation
LatexCommand citep
key "guimaraes_coevol_2011"

\end_inset

 or the variance as a proxy to predict convergence (i.e., large values weak
 convergence whereas small values of the variance may indicate strong convergenc
e, 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismeretal2012"

\end_inset

) and they might overestimate convergence events because they do not consider
 phylogenetic relatedness.
 Using phylogenetic relatedness and phenotypic similarity for the estimation
 of evolutionary convergences in the absence of coevolutionary selection,
 we show that evolutionary trait convergence and complementarity is observed
 in all our replicate simulations but with little and large variation, respectiv
ely.
 Our results contrasts with previous findings 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismeretal2012"

\end_inset

 that under weak or absent coevolutionary selection we always find convergence
 and these convergence values are largely independent of the degree of trait
 complementarity between plant and animals for the animals, but positively
 correlated between plant and animals for the plant community.
\end_layout

\begin_layout Standard
Interestingly, the mechanism of plant-animal interaction considered in our
 model, where the trait of the animal needs to be equal or larger than the
 trait of plant ('phenotypic difference'), has shown to make unlikely the
 evolution of convergence and complementarity by coevolutionary selection
 
\begin_inset CommandInset citation
LatexCommand citep
key "Nuismeretal2012"

\end_inset

.
 However, our model shows that by considering non-selective processes it
 is possible to observe the evolution of both convergence and complementarity.
 It remains to be seen whether the action of both (selective an non-selective
 forces) will be able to generate the observed patterns of high convergence,
 complementarity and nestedness in species-rich mutualistic networks.
\end_layout

\begin_layout Standard
Non-selective forces underlying trait dynamics can produce convergence.
 For example, 
\begin_inset CommandInset citation
LatexCommand citet
key "Stayton_2008"

\end_inset

 simulated evolution along phylogenies according to a Brownian motion model
 of trait change and demonstrated that rates of convergence can be quite
 high when clades are diversifying under only the influence of genetic drift.
 Furthermore, other type of constraints in the production of variation can
 also lead to convergence.
 If the variation produced is limited, then unrelated species are likely
 to produce the same variation, which may then become fixed in the population
 by genetic drift 
\begin_inset CommandInset citation
LatexCommand citep
key "Stayton_2008,Losos_2011"

\end_inset

.
 This may be common feature of biological systems because DNA contains only
 four possible states for a given nucleotide position, and therefore it
 is likely that distantly related taxa will independently acquire the same
 change by chance regardless of the environmental conditions or niche-driven
 dynamics 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

.
 Developmental constraints or the evolution of genetic networks by non-adaptive
 processes may also be explanations for the convergence of traits 
\begin_inset CommandInset citation
LatexCommand citep
key "Sole_convergence_selection_networks,Lynch:2007,Losos_2011"

\end_inset

, but the role of developmental constraints or genetic networks in determining
 convergence in species-rich mutualistic networks has yet not been explored.
 For example, the tinkering of traits by evolutionary forces largely affects
 developmental pathways (e.g.
 gene regulatory networks) 
\begin_inset CommandInset citation
LatexCommand citep
key "Sole_convergence_selection_networks"

\end_inset

.
 Developmental pathways are not static but can diverge through time randomly
 without substantially affecting the phenotype 
\begin_inset CommandInset citation
LatexCommand citep
key "Wagner:2008"

\end_inset

.
 This concept, also called developmental system drift (DSD) 
\begin_inset CommandInset citation
LatexCommand citep
key "True_2001"

\end_inset

, might play an important role in the evolution of convergence in morphological
 traits and it should be considered as another process where drift can act
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ohta_2002"

\end_inset

, for example, by random wiring in gene regulatory networks.
 Our results based on a method that excludes cases of the development of
 a similar trait in related but distinct species descending from the same
 ancestor (i.e., parallel evolution, 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

) show that additional constraints such as dispersal limitation, obligate
 mutualisms and assortative mating limit the production of variation and
 lead consistently to convergence in species-rich mutualistic networks.
\end_layout

\begin_layout Standard
Evolutionary complementarity is also consistently observed in our results
 but with a larger variation than convergence.
 Complementarity is argued to be the main result of tight coevolution between
 mutualistic species by mechanisms, such as trait-matching (e.g.
 corolla length-proboscis length) 
\begin_inset CommandInset citation
LatexCommand citep
key "Jordano-2003"

\end_inset

.
 There is empirical 
\begin_inset CommandInset citation
LatexCommand citep
key "anderson_johnson_2008"

\end_inset

 and theoretical evidence 
\begin_inset CommandInset citation
LatexCommand citep
key "Gomulkiewicz-2000"

\end_inset

 for coevolutionary hot spots 
\begin_inset CommandInset citation
LatexCommand citep
key "Thompson-1999"

\end_inset

, which suggests that local selective regimes can promote the coevolution
 of traits 
\begin_inset CommandInset citation
LatexCommand citep
key "Gomulkiewicz-2000,Ferdy_2002,Gomulkiewicz-2003,Jordano-2003,Bronstein-2006,Thompson-2002,Thompson_2009,Jones_Ferriere_amnat_2009"

\end_inset

.
 In contrast, our results show that low to medium levels of complementarity
 can emerge from relatively non-selective forces and constraints occurring
 at several levels, from geographic limits to encounter partners and disperse
 to the genetic and morphological constraints to producing viable offspring.
 In addition, our model-data fitting show our predictions fit well to the
 observed plant-hummingbird complementarity across a broad range of complementar
ity threshold values (figure 7).
 
\end_layout

\begin_layout Standard
Our model predicts that the distribution of traits, regardless of species
 differences, generally evolves towards a bimodal distribution of phenotypes.
 This result was previously obtained by 
\begin_inset CommandInset citation
LatexCommand citet
key "kondrashov_shpak_1998"

\end_inset

, who studied a model in the absence of selection and with assortative mating
 in a infinite population.
 Their result with strong assortative mating produces high correlations
 of allelic effects among all loci, which leads to the evolution of two
 phenotypic classes: one with alleles increasing the trait and the other
 with alleles decreasing the trait 
\begin_inset CommandInset citation
LatexCommand citep
key "crow_kimura_book"

\end_inset

.
 
\begin_inset CommandInset citation
LatexCommand citet
key "Deaviux_Lande_2008"

\end_inset

 found similar results using a finite diploid population with multiple alleles
 per locus and they showed that the splitting of the phenotype distribution
 is possible under strong assortative mating and genetic drift, but the
 distribution is transient rather than permanent.
 In our model the distribution is not transient, and this may be probably
 due to having only considered two allelic states in our assortative mating
 loci, instead of multiple allelic states, for each locus.
 As 
\begin_inset CommandInset citation
LatexCommand citet
key "Deaviux_Lande_2008"

\end_inset

 explained, by assuming a normal distribution of allelic effects at each
 locus we could obtain a more continuous unimodal (i.e.
 normal) distribution of phenotypes.
 We need further analytical exploration to thoroughly understand the determinant
s of trait distributions in our model.
 Nevertheless, we find a gradient of species phenotypes from low to high
 mean trait values (Insets in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Changes-in-trait"

\end_inset

), but trait distributions for the parameter combination explored are not
 right-skewed, as observed in real plant-pollinator communities 
\begin_inset CommandInset citation
LatexCommand citep
key "stang_2009_annbot"

\end_inset

.
 This might be due to the influence of other traits not considered in our
 model, such as forbidden links (e.g.
 body size) and developmental constraints.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

 explored the connection between convergence and complementarity to nestedness
 patterns in mutualistic networks.
 They show that coevolutionary selection tend to decrease nestedness and
 it generates even more strongly antinested networks when coevolutionary
 selection increases by favoring the emergence of reciprocal specialization.
 In contrast, nestedness values were very high in our model, as in real
 mutualistic networks.
 Previous neutral models taking into account ecological drift 
\begin_inset CommandInset citation
LatexCommand citep
key "Krishna_2008,Canard_2012"

\end_inset

, produced high values of nestedness which suggests that random interactions
 and species abundance distribution ('neutral forbidden links' 
\begin_inset CommandInset citation
LatexCommand citep
key "Canard_2012"

\end_inset

), are determinants of the structure of mutualistic networks.
 Connectance values obtained from our simulations are close to the predictions
 of other neutral network models 
\begin_inset CommandInset citation
LatexCommand citep
key "Canard_2012"

\end_inset

.
 However, compared to real mutualistic networks with similar diversity as
 ours (24 plant and animal species on average), our connectance values (
\begin_inset Formula $\overline{C}=0.5$
\end_inset

) are higher than the reported webs (
\begin_inset Formula $C=0.28$
\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "Olesen_Jordano_2002"

\end_inset

.
 Interestingly, 
\begin_inset CommandInset citation
LatexCommand citet
key "Nuismeretal2012"

\end_inset

 found that only assuming coevolutionary selection forces also leads to
 an increase in connectance.
 This means that both basic genetic and ecological processes and coevolutionary
 selection can increase connectance in mutualistic networks.
 The question is why observed mutualistic webs have a lower connectance
 than those predicted by our model and those considering coevolutionary
 selection.
 We conjecture that this difference in connectance values might be due to
 different types of forbidden links (i.e.
 biological constraints impeding plant-animal interactions), such as phenology
 
\begin_inset CommandInset citation
LatexCommand citep
key "encinas_phenology_2012,Olesen-2008"

\end_inset

, body size 
\begin_inset CommandInset citation
LatexCommand citep
key "Olesen2010"

\end_inset

or environmental fluctuations that were not explicitly included in our approach.
\end_layout

\begin_layout Standard
High values of the required genetic similarity to produce viable offspring,
 
\begin_inset Formula $q_{min}$
\end_inset

, and shorter geographical distances for mating (
\begin_inset Formula $d_{max}$
\end_inset

) lead to higher species diversity in models with one metacommunity 
\begin_inset CommandInset citation
LatexCommand citep
key "melian_2012"

\end_inset

, but low geographic distances for mating could decrease species diversity
 due to the difficulty of finding mates (i.e., Allee effect) or due to inbreeding,
 especially for high genetic similarity threshold values to produce viable
 offspring.
 In our model we assume that genetic incompatibilities, assortative mating
 and morphological traits are determined by the same multiple loci (i.e.
 they have the same genetic basis) and these genes show pleiotropic effects.
 We do not explicitly model how incompatibilities accumulate 
\begin_inset CommandInset citation
LatexCommand citep
key "Welch:2004"

\end_inset

 and assortative mating and morphological traits are calculated in a similar
 way: we sum genetic differences regardless of the magnitude of the influence
 (i.e., effect sizes) of any given locus on this quantitative trait 
\begin_inset CommandInset citation
LatexCommand citep
key "Seehausenetal_2014"

\end_inset

.
 This means that two individuals with different combinations of alleles
 in the genome can express the same quantitative trait 
\begin_inset CommandInset citation
LatexCommand citep
key "Losos_2011"

\end_inset

.
 Our interpretation of non-random mating and an ecological trait may be
 similar to the concept of 'magic' traits 
\begin_inset CommandInset citation
LatexCommand citep
key "Thibert_Gavrilets:2013"

\end_inset

.
 A 'magic' trait combines a trait subject to divergent selection and another
 trait related to nonrandom mating (i.e.
 reproductive isolation) that are pleiotropic expressions of the same gene(s)
 
\begin_inset CommandInset citation
LatexCommand citep
key "Servedio_2011"

\end_inset

.
 There are other alternatives for the relationship between assortative mating
 and the morphological trait 
\begin_inset CommandInset citation
LatexCommand citep
key "Servedio_2011"

\end_inset

.
 For instance, assortative mating and the morphological trait may be determined
 by different sets of genes and express different levels of pleiotropic
 effects (i.e.
 a partial 'magic' trait 
\begin_inset CommandInset citation
LatexCommand citep
key "van_doorn_weissing_2001"

\end_inset

).
 One might also explore further the influence of the morphological constraint
 on the evolution of traits.
 In our model, this constraint might be exerting weak selection on the plant
 traits because some pollinator individuals may be able to interact with
 a larger number of plants.
 The comparison with other models without any morphological constraint (i.e.
 only non-random mating) and with morphological constraints for animals
 and plant reproduction (i.e.
 phenotypic matching) might elucidate the importance of morphological constraint
s in the evolution of mutualistic networks.
\end_layout

\begin_layout Standard
In summary, our results show the emergence of convergence, complementarity
 and nestedness following basic genetic and ecological processes.
 We did not find high levels of convergence and complementarity but our
 predictions fit well to the observed plant-hummingbird complementarity
 and hummingbird convergence.
 In contrast to previous studies showing antinested networks when considering
 coevolutionary selection, we found that, in the absence of coevolutionary
 selection, highly nested values are obtained in agreement with the empirical
 mutualistic networks 
\begin_inset CommandInset citation
LatexCommand citep
key "Bascompte-2003"

\end_inset

.
 Our results suggest that diversification dynamics combining ecological
 (demography and dispersal limitation), population genetics (mutation, recombina
tion, assortative mating and drift) and morphological constraints may form
 the basic processes producing the key patterns of mutualistic networks,
 from trait convergence and complementarity to connectance and nestedness.
 More generally, our model shows that it is important to consider non-selective
 forces to explain broad evolutionary patterns and the emergence of community
 structure in species-rich interacting networks.
\end_layout

\begin_layout Section*

\size large
Acknowledgments
\end_layout

\begin_layout Standard
We thank Martina Stang and Ole Seehausen for useful discussions.
 FEV and RSE were supported by grants from the Netherlands Organization
 for Scientific Research (NWO).
 CJM was supported by the Swiss National Science Foundation (SNSF-project
 31003A-144162).
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset

  
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "franeviso"
options "ecol_let"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Tables
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Glossary of mathematical notation and parameter values
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="27" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Notation 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Definition
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Values 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J^{P},J^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Effective population size of plants (P) and animals (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,000 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{ij}^{P},d_{ij}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geographical pairwise distance plants (P) and animals (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{max}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum geographical distance to mate and disperse
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $D^{P},D^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geographic distance matrix with all 
\begin_inset Formula $d_{ij}^{P}$
\end_inset

 and 
\begin_inset Formula $d_{ij}^{A}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{ik}^{PA}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geographical distance between plant 
\begin_inset Formula $i$
\end_inset

 and animal 
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{max}^{PA}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum geographical distance to find a mutualistic partner
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $D^{PA}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geographic distance matrix with all the 
\begin_inset Formula $d_{ik}^{PA}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $q_{ij}^{P},q_{ij}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Genetic similarity between ind.
 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Q^{P},Q^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Genetic similarity matrix with all the 
\begin_inset Formula $q_{ij}^{P}$
\end_inset

 and 
\begin_inset Formula $q_{ij}^{P}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $q_{min}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum genetic similarity to have viable offspring
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.97 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $z_{i}^{P},z_{i}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quantitative trait of ind.
 
\begin_inset Formula $i$
\end_inset

 in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Z^{P},Z^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quantitative trait distribution in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{ij}^{P},p_{ij}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phenotypic similarity between ind.
 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathcal{P}^{P},\mathcal{P}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phenotypic similarity matrix with all the 
\begin_inset Formula $p_{ij}^{P}$
\end_inset

 and 
\begin_inset Formula $p_{ij}^{A}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size of the genome
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $g_{i}^{P},g_{i}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Genetic component of phenotype of offspring in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Environmental component of phenotype of offspring
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathcal{N}$
\end_inset

(0,1) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mutation rate per locus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{-4}-10^{-2}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{q}_{kh}^{P},\hat{q}_{kh}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean genetic simil.
 between species 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Q_{s}^{P},Q_{s}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Species genetic simil.
 matrix with all 
\begin_inset Formula $\hat{q}_{kl}^{P}$
\end_inset

 and 
\begin_inset Formula $\hat{q}_{kl}^{A}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{p}_{kh}^{P},\hat{p}_{kh}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean phen.
 simil.
 between species 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 in (P) and (A)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P_{s}^{P},P_{s}^{A}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Species phen.
 simil.
 matrix with all 
\begin_inset Formula $\hat{p}_{kl}^{P}$
\end_inset

 and 
\begin_inset Formula $\hat{p}_{kl}^{A}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{p}_{kh}^{PA}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mean trait similarity plant species 
\begin_inset Formula $k$
\end_inset

 and animal species 
\begin_inset Formula $h$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P_{s}^{PA}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phenotypic simil.
 matrix with all 
\begin_inset Formula $\hat{p}_{kh}$
\end_inset

 values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
\size footnotesize
\begin_inset script superscript

\begin_layout Plain Layout

\size normal
h
\end_layout

\end_inset

conv
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phenotypic threshold to calculate convergence events
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
\size footnotesize
\begin_inset script superscript

\begin_layout Plain Layout

\size normal
h
\end_layout

\end_inset

comp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Phenotypic threshold to calculate complementarity events
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{linenumbers}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Figures
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/IBModel6.eps
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
This figure summarizes the death-birth cycle per time step.
 Individuals are represented as filled circles and blue tones represent
 variation of phenotypes.
 (A) an individual 
\begin_inset Formula $k$
\end_inset

 is randomly selected to die and leaves an empty location in the landscape.
 (B) a female individual, 
\begin_inset Formula $\venus$
\end_inset

, is randomly selected among all females satisfying the condition 
\begin_inset Formula $d_{k\venus}<d_{max}$
\end_inset

.
 We then choose randomly a male, 
\begin_inset Formula $\mars$
\end_inset

, among all males satisfying 
\begin_inset Formula $d_{k\mars}<d_{max}$
\end_inset

 and 
\begin_inset Formula $q_{\venus\male}>q_{min}$
\end_inset

 with 
\begin_inset Formula $q_{min}$
\end_inset

, the minimum genetic similarity required for mating.
 In addition to these two constraints, two more are required to complete
 mating.
 For the condition of obligate mutualism, the geographic distance between
 the female (animal or plant), and an animal (or plant) individual 
\begin_inset Formula $j$
\end_inset

, must satisfy 
\begin_inset Formula $d_{j\venus}^{PA}<d_{max}^{PA}$
\end_inset

.
 Finally, female plants need the presence of an animal pollinator with a
 larger or equally-sized proboscis than the corolla of the female plant,
 thus individual pollinators represented as 
\begin_inset Formula $j$
\end_inset

, must satisfy 
\begin_inset Formula $z_{\venus_{P}}\leq z_{j_{A}}$
\end_inset

.
 In (C) and (D) we calculate the genome of the new offspring once these
 constraints are satisfied.
 (C) Genomes are composed of 
\begin_inset Formula $L$
\end_inset

 loci where each locus can be in two allelic states (
\begin_inset Formula $-1,\,1$
\end_inset

) and undergo block crossover recombination between female (dark gray) and
 male (black).
 A position 
\begin_inset Formula $l$
\end_inset

 in the genome of the parents is randomly chosen partitioning the genome
 in two blocks.
 All genes beyond the 
\begin_inset Formula $l$
\end_inset

 locus in either organism's genome is swapped between two parents and two
 new genomes are formed.
 (D) One of the two new genomes is randomly chosen for the offspring 
\begin_inset Formula $i$
\end_inset

, 
\begin_inset Formula $S_{o}^{i}$
\end_inset

, and it might undergo mutation (light gray).
 (E) The phenotype expression of offspring 
\begin_inset Formula $i$
\end_inset

 is 
\begin_inset Formula $z_{i}=g_{i}+\epsilon$
\end_inset

 with 
\begin_inset Formula $g_{i}=L+S_{o}^{i}$
\end_inset

 and 
\begin_inset Formula $\epsilon$
\end_inset

 are the genetic and environmental component of the phenotype, respectively.
 (F) The offspring 
\begin_inset Formula $i$
\end_inset

 occupies the site of the dead individual 
\begin_inset Formula $k$
\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Recombination"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/convergence.eps
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
This figure illustrates a simple example of evolutionary convergence using
 species 
\begin_inset Formula $a$
\end_inset

, 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

.
 The upper matrix (
\begin_inset Formula $Q_{S}=[\hat{q}_{kl}]$
\end_inset

) shows species 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 are genetically closely related, 
\begin_inset Formula $\hat{q}_{ac}=0.97$
\end_inset

, while genetically distant from species 
\begin_inset Formula $b$
\end_inset

 (
\begin_inset Formula $\hat{q}_{ab}=0.85$
\end_inset

, 
\begin_inset Formula $\hat{q}_{cb}=0.89$
\end_inset

).
 A clear description of these genetic relationships can be represented with
 a cluster tree or dendrogram, as shown in the lower part of the figure.
 Thus, we establish that species 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 are sister species.
 The species phenotypic similarity matrix, 
\begin_inset Formula $P_{S}=[\hat{p}_{kh}]$
\end_inset

 shows that species 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 are phenotypically highly similar (
\begin_inset Formula $\hat{p}_{ab}=0.98$
\end_inset

) and highly genetically dissimilar (
\begin_inset Formula $\hat{q}_{ab}=0.85$
\end_inset

) (i.e.
 more than the average intraspecific genetic similarity or sister species
 
\begin_inset Formula $~0.97$
\end_inset

), indicating an event of evolutionary convergence.
\begin_inset CommandInset label
LatexCommand label
name "fig:Evolutionary-convergence"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/trait_dist_2.eps
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Changes in trait distribution of plants (top, blue) and animals (bottom,
 red).
 Left and right panels show the initial and final trait distribution, respective
ly.
 The insets in the right panels show the mean trait and standard error for
 each species sorted from the most common to the most rare.
 Initial trait distributions changed towards higher variance, and in most
 replicates, towards bimodal distribution in both guilds.
 Plot shows the outputs from one replicate with parameters values
\series bold
 
\begin_inset Formula $q_{min}=0.97$
\end_inset

, 
\begin_inset Formula $d_{max}=d_{max}^{PA}=0.3$
\end_inset

, 
\begin_inset Formula $\mu=5\times10^{-3}$
\end_inset

 and 
\begin_inset Formula $J_{P}=J_{A}=1,000$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:Changes-in-trait"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/ConvComp3.eps
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Evolutionary convergence and complementarity in plant-pollinator networks.
 Trees at the left and right side show genetic similarities between animal
 (red) and plant (blue) species, respectively.
 Mean species trait, proboscis and corolla length, is sketched with cartoons
 next to their respective position in the trees.
 Animals, composed by six species, have two evolutionary convergence events
 (A-B and F-D).
 Plants, composed by three species, have one convergent event (b-c).
 The central part of the figure shows the network of plant-animal interactions,
 where each node (colored filled circles) represents an individual.
 The network is composed of two types of links: genetic relatedness links
 (black solid) forming clusters that represent species and plant-animal
 individual-based interaction links (gray).
 The network shows variability in terms of genetic relatedness and plant-animal
 interactions within a species (i.e.
 high intraspecific variability).
 This figure is an example from one replicate simulation.
 Parameters used are as in figure 3,
\series bold
 
\begin_inset Formula $q_{min}=0.97$
\end_inset

, 
\begin_inset Formula $d_{max}=d_{max}^{PA}=0.3$
\end_inset

, 
\begin_inset Formula $\mu=5\times10^{-3}$
\end_inset

 and 
\begin_inset Formula $J^{P}=J^{A}=1,000$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:convergence-complementarity"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/phengen.eps
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The effect of mutation rate on the genotype-phenotype relationship.
 Top and bottom panels show the genotype-phenotype relationship for animals
 (red) and plants (blue), respectively.
 Right panels show the genotype-phenotype relationship for mutation rate
 
\begin_inset Formula $\mu=5\times10^{-3}$
\end_inset

 and left panels for 
\begin_inset Formula $\mu=10^{-4}$
\end_inset

.
 Each plot is a scatter plot, where each filled circle represents phenotypic
 and genetic similarity between two individuals of a particular guild (plant
 or animal) from one replicate.
 Individuals with high phenotypic similarity and genetic dissimilarity suggests
 evolutionary convergence of traits, regardless of mutation rate.
 Parameters used are
\series bold
 
\begin_inset Formula $q_{min}=0.97$
\end_inset

, 
\begin_inset Formula $d_{max}=d_{max}^{PA}=0.3$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $J_{P}=J_{A}=1,000$
\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Genotype-phenotype-relationship-"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/matrix_plantpersp_b005_2.eps
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Plant-animal species interaction network.
 Plant species are represented in rows and animal species in columns.
 The color gradient indicates the number of mutualistic partners (i.e.
 individuals interacting) shared between plant and animal species.
 This matrix comes from one replicate with nine plant and thirteen animal
 species.
 The network shows high level of nestedness (
\begin_inset Formula $N=0.72$
\end_inset

) and intermediate level of connectance (
\begin_inset Formula $C=0.5$
\end_inset

).
 Parameters used are 
\begin_inset Formula $q_{min}=0.97$
\end_inset

, 
\begin_inset Formula $d_{max}=d_{max}^{PA}=0.3$
\end_inset

, 
\begin_inset Formula $\mu=5\times10^{-3}$
\end_inset

 and 
\begin_inset Formula $J_{P}=J_{A}=1,000$
\end_inset

.
\series bold

\begin_inset CommandInset label
LatexCommand label
name "fig:nestedness"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/compandconv-2.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of model's predictions with estimations of convergence and complement
arity from an empirical data of a plant-pollinator community.
 a) Shows the proportion of complementarity events (y-axis) as a function
 of the complementarity threshold (x-axis) for the empirical data (dotted
 black line) and for the model (continuous and dotted lines represent mean,
 0.05 and 0.95 CI values, respectively).
 Predictions are within the CI for most complementarity threshold values.
 Empirical data deviates from model predictions for complementarity values
 around 0.4 and lower.
 b) Shows the proportion of convergence events in the plant community (y-axis,
 69 species) as a function of the convergence threshold (x-axis) for the
 empirical data (dotted black line) and for the model (continuous and dotted
 lines represent mean, 0.05 and 0.95 CI values, respectively).
 Convergence events in the empirical data strongly deviates from model predictio
ns for convergence threshold values ranging between 1 and 0.82.
 In that range, model predicts much higher proportion of convergence events
 than the empirical observations.
 c) Shows the proportion of convergence events in the animal community (y-axis,
 24 species) as a function of the convergence threshold (x-axis) for the
 empirical data (dotted black line) and for the model (continuous and dotted
 lines represent mean, 0.05 and 0.95 CI values, respectively).
 Convergence events in the empirical data are within the CI of model predictions
 for most convergence threshold values.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset

 
\end_layout

\end_body
\end_document
